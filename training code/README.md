# Обучение модели

## Запуск обучения
```python
python main.py --config_filename <путь к файлу конфигурации>
```

## Конфигурация модели

### Общая информация

- **experiment_name**: Название эксперимента, используемое для идентификации процесса обучения и сохранения результатов.
- **seed**: Начальное значение для генерации случайных чисел, используемое для воспроизводимости эксперимента.

### Пути и директории

- **directories**:
  - **images**: Директория, содержащая набор данных изображений для обучения.
  - **backgrounds**: Директория с фоновыми изображениями для добавления в основной набор данных.
  - **models**: Директория для сохранения обученных моделей и загрузки чекпойнтов.

### Настройки функции потерь

- **criterion**:
  - **type**: Тип функции потерь, используемой в обучении.

### Настройки набора данных

- **dataset**:
  - **image_size**: Размер изображений после изменения масштаба.
  - **insert_background_p**: Вероятность добавления фона к изображению.
  - **background_max_ratio**: Максимальное соотношение размера фона к изображению.
  - **data_fraction**: Доля данных, используемая для обучения и валидации.
  - **val_part**: Доля данных, выделяемая для валидационного набора.
  - **data_loaders**:
    - **train_batch_size**: Размер батча для обучающего набора.
    - **val_batch_size**: Размер батча для валидационного набора.
  - **pre_transforms**: Преобразования, применяемые к изображениям до аугментации.
  - **train_augmentations**: Аугментации, применяемые в процессе обучения.
  - **val_augmentations**: Аугментации, применяемые для валидационного набора.
  - **post_transforms**: Преобразования, применяемые к изображениям после аугментации.
  - **augmentation_p_schedule**:
    - **start_p**: Начальная вероятность применения аугментации.
    - **end_p**: Конечная вероятность применения аугментации.
    - **exponent_factor**: Фактор изменения вероятности аугментации с течением времени.

### Настройки модели

- **model**:
  - **load_from**: Путь к предварительно обученной модели для дообучения.
  - **backbone_name**: Название архитектуры или сети, используемой в качестве основы модели.
  - **pretrained**: Флаг, указывающий на использование предварительно обученных весов.
  - **in_channels**: Количество входных каналов изображения.
  - **n_classes**: Количество классов для задачи классификации.

### Оптимизатор

- **optimizer**:
  - **lr_type**: Метод задания скорости обучения (единый или разделённый для отдельных параметров модели).
  - **type**: Тип используемого оптимизатора.
  - **lr**: Начальная скорость обучения.
  - **weight_decay**: Коэффициент регуляризации для предотвращения переобучения.
  - **eps**: Малое значение для численной стабильности.
  - **betas**: Параметры для контроля скорости обучения и адаптации градиентов.

### Планировщик обучения

- **scheduler**:
  - **anneal_strategy**: Алгоритм уменьшения скорости обучения в процессе обучения модели.
  - **div_factor**: Коэффициент, определяющий начальное снижение скорости обучения.
  - **final_div_factor**: Коэффициент, определяющий финальное снижение скорости обучения.
  - **pct_start**: Процент итераций до достижения максимальной скорости обучения.

### Настройки обучения

- **training**:
  - **compile**: Флаг для компиляции модели с оптимизациями.
  - **save_checkpoints**: Флаг для сохранения контрольных точек модели.
  - **save_metrics**: Флаг для сохранения метрик обучения.
  - **epochs**: Количество эпох обучения.
  - **accumulate_grad_batches**: Количество батчей для накопления градиентов перед обновлением весов.
  - **max_grad_norm**: Максимальная норма градиента для его обрезки.
  - **precision**: Точность вычислений.
  - **mixing**:
    - **strategy**: Стратегия смешивания изображений.
    - **p**: Вероятность применения стратегии смешивания.
    - **alpha**: Параметр альфа для стратегии MixUp или CutMix.
